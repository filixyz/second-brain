## 2.4 DNS—The Internet’s Directory Service
Hosts can be identified by their **host-name** (google) or it’s **IP address** (121.7.106.83). 

The Internets **Domain Name System** is an application layer protocol that maps human-friendly (and readable) mnemonics, a Host-name, with it’s actual IP address stored in the DNS’s distributed database .

The Domain Name System (DNS) is:
1)  A distributed database implemented in the hierarchy of DNS servers
2) An application layer protocol that allows host query the distributed database

The DNS protocol runs over UDP and uses port 53. 

Typical course of events that occur when we query a DNS are:
1) user machine run client side of DNS application
2) Browser extracts the host-name eg. www.site.com from the URL and passes the host-name to the client side of the DNS application
3) DNS client send query containing host-name to a DNS server
4) DNS client eventually receives a reply, which includes the IP address for the host-name, and forwards it to the browser
5) Browser receives it and can now initiate TCP connection to the HTTP server process at port 80 at that IP address.

DNS can adds a certain delay when retrieving an IP address of a requested host-name; sometimes this delay can be tangible depending on the state of the DNS network. A Nearby DNS cache server can help mitigate this delay.

## Services provided by  DNS
1) Host aliasing: Hosts with complicated names can have given shorter mnemonics with the help of DNS. The initial host name in which we might wish to alias is known as the hosts **canonical name**
2) Mail server aliasing
3) Load Distribution; An internet network service, say CNN, can have multiple IP addresses that link to different servers that host it’s service, DNS can help map this array of IP addresses to one single host name with the added benefit of rotating the host names with each response list it sends to a client that requested for the service actual IP address. Since end systems typically make requests to the first IP address in the list responded back it by the DNS server, this act of rotation help with distributing the load on the internet network service.

DNS is specified by RFC 1034  and RFC 1035.
### How DNS works in a more precise context
The actual DNS infrastructure is a complex system made of different layers of DNS serves all working holistically to actualize the DNS service of Host name to IP address mapping.

The internet DNS architecture is made up of three layers:
1) **The root DNS layer**: maps queries to the IP address of the Top level domain DNS that can grant access to the IP
2) **Top level Domain DNS layer**:  maps queries to the IP address of the authoritative DNS servers that manages the actual IP address of the required  host name.
3) and **The Authoritative DNS layer**: maps host name queries to the actual IP address of the required host.
Lets work through a scenario where an end system requires the IP address to a host its trying to access. The end system browser queries its search bar for say `www.site.en`, the browser in return passes said query (which is the domain name `site.en`) to the end systems DNS client process or program, the DNS client receipts the host name query and establishes a connection to the local DNS server most accessible to it saying, allegorically, “help me retrieve the IP address of this domain on my behalf”. The local DNS then makes a request to a root DNS, this DNS then responds with the IP addresses of Top level domain DNS’s that can handle the query, this response is then returned to the local DNS. The local DNS then uses the response list of Top level domain DNS servers IPs  querying one of them with the intended host name to be mapped, One of the TLD DNS serves receives the request and responds with the IP address of the authoritative DNS server that handles all host-name-to-IP mapping related to the  host-name. The Local DNS, Upon receiving the IP address to the authoritative DNS server IP address, then queries that authoritative DNS server, the server retrieves the query and responds with the IP address to the actual host being searched for. The local DNS server receives the IP address of the host that the end system required and that forward that IP address back to the end systems DNS client at port 53 as a UDP datagram, the DNS client retrieves the IP address and forwards it to the browser and then the end system can now access  `www.site.en`. 

Caching can happen within the servers, hosts or end-systems, within any layer of the DNS architecture. Caching mostly occurs at the local DNS server.

This architecture can either be of an iterative model or a recursive one, with an iterative model only the requesting DNS server performs the requests to the DNS servers within the layers of the DNS architecture. 

But in a recursive model, the DNS server at a higher layer makes the request to servers at the layer below it, and this happens recursively within all layers until the the IP address of the requested host has been achieved, then the response is then pushed back across the layers from lowest to highest, until the requesting end system receives the map.


### 2.4.3 DNS Records and Messages
Refer back to the book if you need to know about DNS messages format. There are only two kinds of DNS messages; query and response.

DNS servers that together implement the DNS distributed database; store **resource records (RRs)**, These are what provide the host-name to IP address mapping:

A resource record is stored as a four tuple with the following fields:
```r
(Name Value, Type, TTL)
```
TTL is the time to live; the time in which when elapsed the current cached content of the record should be deleted (or possibly updated).

If we ignore the TTL, below is the list of the possible meaning of different Resource Records based on their `Type` value:
1) if `Type=A`, meaning this is an A record, the `Name` is evaluates to the host-name and `Value` evaluates to its actual IP address. eg `(bar.foo.com, 145.37.93.126, A)`
2) if `Type=NS`, meaning this is a record to an authoritative DNS server, `Name` evaluates to the Domain name and `Value` evaluated to the host name of the authoritative DNS server that knows how to obtain IP address associated to the domain name. eg. `(foo.com, dns.foo.com, NS)`an NS Record.
3) if `Type=CNAME`, then `Value` is a canonical host-name for the alias host-name `Name`. eg. `(foo.com, bar.foo.com, CNAME)`, this is a C NAME record
4) if `TYPE=MX`, then `Value` is the canonical name of a mail server that has a host name `Name`.
if a DNS server is authoritative for a particular host name then the DNS server will contain a Type A record of that host-name, if the server is not an authoritative one then the server will contain type NS record for the domain that includes the host-name; it will also provide an A record for that domain.

## 2.5 Peer-to-Peer File Distribution.

An example of the peer to peer file distribution architecture is the bittorrent protocol, which i am trying to implement. The P2P architecture is self scaling.


